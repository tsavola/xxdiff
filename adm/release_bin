#!/bin/sh
#
# $RCSfile$
#

if [ ! -d "adm" ]; then
     echo "You must be running this script from the topdir directory."
     exit 1;
fi

# Package for simple binary release.
VERSION=`adm/get_version`
echo "Making binary release version $VERSION"

PLAT=`adm/config.guess`
case $PLAT in
        *sparc*)
        PEXT=sparc ;;

        *mips*)
        PEXT=mips ;;

        *linux*)
        PEXT=i386 ;;
esac
    
PDIR=xxdiff-$VERSION.$PEXT
ROOT=..

mkdir $ROOT/$PDIR
cp bin/* $ROOT/$PDIR

strip $ROOT/$PDIR/xxdiff

cp src/xxdiff.1 $ROOT/$PDIR
cp README $ROOT/$PDIR
cp CHANGES $ROOT/$PDIR

$ROOT/$PDIR/xxdiff --help-html > $ROOT/$PDIR/xxdiff-doc.html

cd ..
tar cvf - $PDIR | gzip > $PDIR.tar.gz
rm -rf $PDIR
